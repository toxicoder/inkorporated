<!DOCTYPE html>
<html lang="en" class="palette-1"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Inkorporated Homelab Documentation | Comprehensive documentation for the Inkorporated homelab project.</title>
<meta name="generator" content="Jekyll v4.4.1" />
<meta property="og:title" content="Inkorporated Homelab Documentation" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Comprehensive documentation for the Inkorporated homelab project." />
<meta property="og:description" content="Comprehensive documentation for the Inkorporated homelab project." />
<link rel="canonical" href="https://toxicoder.github.io/inkorporated/architecture/dgx_integration_plan.html" />
<meta property="og:url" content="https://toxicoder.github.io/inkorporated/architecture/dgx_integration_plan.html" />
<meta property="og:site_name" content="Inkorporated Homelab Documentation" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Inkorporated Homelab Documentation" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","description":"Comprehensive documentation for the Inkorporated homelab project.","headline":"Inkorporated Homelab Documentation","url":"https://toxicoder.github.io/inkorporated/architecture/dgx_integration_plan.html"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/inkorporated/assets/css/style.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@400;500;700&family=Roboto:wght@400;500;700&display=swap" rel="stylesheet"><link type="application/atom+xml" rel="alternate" href="https://toxicoder.github.io/inkorporated/feed.xml" title="Inkorporated Homelab Documentation" /><script>
    window.searchUrl = "/inkorporated/search.json";
  </script>
</head>
<!-- Extra CSS -->
  

  <body><header class="app-bar">
  <button id="menu-toggle" class="btn btn-outlined" style="margin-right: 16px; display: none;" aria-label="Toggle navigation">
    <span style="font-size: 20px;">â˜°</span>
  </button>
  <div class="title">
    <a href="/inkorporated/" style="color: inherit;">Inkorporated Homelab Documentation</a>
  </div>
  <div style="flex: 1;"></div>
  <div class="nav-controls">
    <a href="https://github.com/toxicoder/materialistic-jekyll" class="icon-btn outlined" aria-label="GitHub Repository" style="margin-left: 8px;" target="_blank" rel="noopener noreferrer">
      <svg viewBox="0 0 24 24" width="24" height="24" fill="currentColor">
        <path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/>
      </svg>
    </a>
    <button id="theme-settings-btn" class="icon-btn outlined" aria-label="Theme Settings" style="margin-left: 8px;">
      <span style="font-size: 20px;">ðŸŽ¨</span>
    </button>
    <div id="theme-dialog" class="dialog modal" style="display: none; opacity: 0; transition: opacity 0.2s; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); z-index: 100;">
  <h3 class="dialog-headline">Theme Settings</h3>
  <div class="dialog-content">

    <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 24px;">
      <span style="font-size: 16px; font-weight: 500;">Dark Mode</span>
      <label class="switch">
        <input type="checkbox" id="dark-mode-switch">
        <span class="slider-track"></span>
      </label>
    </div>

    <div style="margin-bottom: 16px;">
      <span style="font-size: 16px; font-weight: 500; display: block; margin-bottom: 12px;">Color Palette</span>
      <div class="palette-grid">
        
          <button class="palette-swatch" data-palette-id="palette-1" aria-label="Purple" title="Purple" style="background-color: #4B11E3;">
          </button>
        
          <button class="palette-swatch" data-palette-id="palette-2" aria-label="Red 2" title="Red 2" style="background-color: #DB5E83;">
          </button>
        
          <button class="palette-swatch" data-palette-id="palette-3" aria-label="Red 3" title="Red 3" style="background-color: #A62952;">
          </button>
        
          <button class="palette-swatch" data-palette-id="palette-4" aria-label="Red 4" title="Red 4" style="background-color: #CF0B3D;">
          </button>
        
          <button class="palette-swatch" data-palette-id="palette-5" aria-label="Orange 5" title="Orange 5" style="background-color: #AA4909;">
          </button>
        
          <button class="palette-swatch" data-palette-id="palette-6" aria-label="Gold" title="Gold" style="background-color: #6D5906;">
          </button>
        
          <button class="palette-swatch" data-palette-id="palette-7" aria-label="Green 7" title="Green 7" style="background-color: #4E6105;">
          </button>
        
          <button class="palette-swatch" data-palette-id="palette-8" aria-label="Green 8" title="Green 8" style="background-color: #0C8F08;">
          </button>
        
          <button class="palette-swatch" data-palette-id="palette-9" aria-label="Teal" title="Teal" style="background-color: #06695A;">
          </button>
        
          <button class="palette-swatch" data-palette-id="palette-10" aria-label="Cyan 10" title="Cyan 10" style="background-color: #06636E;">
          </button>
        
          <button class="palette-swatch" data-palette-id="palette-11" aria-label="Blue 11" title="Blue 11" style="background-color: #07618C;">
          </button>
        
          <button class="palette-swatch" data-palette-id="palette-12" aria-label="Blue 12" title="Blue 12" style="background-color: #0A54C5;">
          </button>
        
          <button class="palette-swatch" data-palette-id="palette-13" aria-label="Blue 13" title="Blue 13" style="background-color: #3824C1;">
          </button>
        
          <button class="palette-swatch" data-palette-id="palette-14" aria-label="Purple 14" title="Purple 14" style="background-color: #912AAA;">
          </button>
        
          <button class="palette-swatch" data-palette-id="palette-15" aria-label="Red 15" title="Red 15" style="background-color: #C70B3D;">
          </button>
        
          <button class="palette-swatch" data-palette-id="palette-16" aria-label="Red" title="Red" style="background-color: #CE120B;">
          </button>
        
          <button class="palette-swatch" data-palette-id="palette-17" aria-label="Red 17" title="Red 17" style="background-color: #BD2A0A;">
          </button>
        
          <button class="palette-swatch" data-palette-id="palette-18" aria-label="Orange 18" title="Orange 18" style="background-color: #8D4A07;">
          </button>
        
          <button class="palette-swatch" data-palette-id="palette-19" aria-label="Orange 19" title="Orange 19" style="background-color: #755606;">
          </button>
        
          <button class="palette-swatch" data-palette-id="palette-20" aria-label="Yellow 20" title="Yellow 20" style="background-color: #5B5D05;">
          </button>
        
          <button class="palette-swatch" data-palette-id="palette-21" aria-label="Green 21" title="Green 21" style="background-color: #447806;">
          </button>
        
          <button class="palette-swatch" data-palette-id="palette-22" aria-label="Cyan 22" title="Cyan 22" style="background-color: #056839;">
          </button>
        
          <button class="palette-swatch" data-palette-id="palette-23" aria-label="Cyan 23" title="Cyan 23" style="background-color: #056761;">
          </button>
        
          <button class="palette-swatch" data-palette-id="palette-24" aria-label="Blue 24" title="Blue 24" style="background-color: #07627D;">
          </button>
        
          <button class="palette-swatch" data-palette-id="palette-25" aria-label="Deep Blue" title="Deep Blue" style="background-color: #0A60B7;">
          </button>
        
          <button class="palette-swatch" data-palette-id="palette-26" aria-label="Blue 26" title="Blue 26" style="background-color: #0C30E5;">
          </button>
        
          <button class="palette-swatch" data-palette-id="palette-27" aria-label="Blue 27" title="Blue 27" style="background-color: #540EE3;">
          </button>
        
          <button class="palette-swatch" data-palette-id="palette-28" aria-label="Purple 28" title="Purple 28" style="background-color: #A214C8;">
          </button>
        
          <button class="palette-swatch" data-palette-id="palette-29" aria-label="Pink 29" title="Pink 29" style="background-color: #D10B79;">
          </button>
        
          <button class="palette-swatch" data-palette-id="palette-30" aria-label="Pink" title="Pink" style="background-color: #D30B3A;">
          </button>
        
          <button class="palette-swatch" data-palette-id="palette-31" aria-label="Red 31" title="Red 31" style="background-color: #B60A13;">
          </button>
        
          <button class="palette-swatch" data-palette-id="palette-32" aria-label="Red 32" title="Red 32" style="background-color: #B02609;">
          </button>
        
          <button class="palette-swatch" data-palette-id="palette-33" aria-label="Orange 33" title="Orange 33" style="background-color: #9A4108;">
          </button>
        
          <button class="palette-swatch" data-palette-id="palette-34" aria-label="Orange 34" title="Orange 34" style="background-color: #805107;">
          </button>
        
          <button class="palette-swatch" data-palette-id="palette-35" aria-label="Yellow 35" title="Yellow 35" style="background-color: #655C05;">
          </button>
        
          <button class="palette-swatch" data-palette-id="palette-36" aria-label="Green 36" title="Green 36" style="background-color: #4A6205;">
          </button>
        
          <button class="palette-swatch" data-palette-id="palette-37" aria-label="Green 37" title="Green 37" style="background-color: #286705;">
          </button>
        
          <button class="palette-swatch" data-palette-id="palette-38" aria-label="Green 38" title="Green 38" style="background-color: #05682F;">
          </button>
        
          <button class="palette-swatch" data-palette-id="palette-39" aria-label="Cyan 39" title="Cyan 39" style="background-color: #056751;">
          </button>
        
          <button class="palette-swatch" data-palette-id="palette-40" aria-label="Cyan 40" title="Cyan 40" style="background-color: #06646C;">
          </button>
        
          <button class="palette-swatch" data-palette-id="palette-41" aria-label="Blue 41" title="Blue 41" style="background-color: #076189;">
          </button>
        
          <button class="palette-swatch" data-palette-id="palette-42" aria-label="Blue 42" title="Blue 42" style="background-color: #0B50D0;">
          </button>
        
          <button class="palette-swatch" data-palette-id="palette-43" aria-label="Blue 43" title="Blue 43" style="background-color: #181DDD;">
          </button>
        
          <button class="palette-swatch" data-palette-id="palette-44" aria-label="Purple 44" title="Purple 44" style="background-color: #6E19C9;">
          </button>
        
          <button class="palette-swatch" data-palette-id="palette-45" aria-label="Pink 45" title="Pink 45" style="background-color: #C0109C;">
          </button>
        
          <button class="palette-swatch" data-palette-id="palette-46" aria-label="Red 46" title="Red 46" style="background-color: #D50B4C;">
          </button>
        
          <button class="palette-swatch" data-palette-id="palette-47" aria-label="Red 47" title="Red 47" style="background-color: #DB0C16;">
          </button>
        
          <button class="palette-swatch" data-palette-id="palette-48" aria-label="Red 48" title="Red 48" style="background-color: #C31A0A;">
          </button>
        
          <button class="palette-swatch" data-palette-id="palette-49" aria-label="Orange 49" title="Orange 49" style="background-color: #954608;">
          </button>
        
          <button class="palette-swatch" data-palette-id="palette-50" aria-label="Orange 50" title="Orange 50" style="background-color: #775506;">
          </button>
        
      </div>
    </div>

  </div>
  <div class="dialog-actions">
    <button class="btn btn-text" id="close-theme-dialog">Close</button>
  </div>
</div>
<!-- Backdrop -->
<div id="theme-backdrop" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.32); z-index: 99; opacity: 0; transition: opacity 0.2s;"></div>

  </div>
</header>
<div class="main-container"><nav class="sidebar">
  <div class="sidebar-header" style="padding-bottom: 16px;">
    <strong>Navigation</strong>
  </div>

  <div class="sidebar-search">
    <div class="search-wrapper">
      <div class="search-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="20" height="20" fill="currentColor">
          <path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/>
        </svg>
      </div>
      <input type="text" id="search-input" placeholder="Search..." aria-label="Search documentation">
    </div>
    <div id="search-results" class="search-results"></div>
  </div>

  
    <ul class="nav-list">
      
        

<li class="nav-item">
  
    <a class="nav-link " href="/inkorporated/">
      Home
    </a>
  
</li>

      
        

<li class="nav-item">
  
    <details >
      <summary class="nav-link">
        Core Concepts
        <svg class="nav-arrow" viewBox="0 0 24 24" width="24" height="24">
          <path d="M7.41 8.59L12 13.17l4.59-4.58L18 10l-6 6-6-6 1.41-1.41z"/>
        </svg>
      </summary>
      <ul class="nav-list nested">
        
          

<li class="nav-item">
  
    <a class="nav-link " href="/inkorporated/guides/overview.html">
      Project Overview
    </a>
  
</li>

        
          

<li class="nav-item">
  
    <a class="nav-link " href="/inkorporated/architecture/index.html">
      Architecture
    </a>
  
</li>

        
          

<li class="nav-item">
  
    <a class="nav-link " href="/inkorporated/architecture/network.html">
      Network Topology
    </a>
  
</li>

        
          

<li class="nav-item">
  
    <a class="nav-link " href="/inkorporated/architecture/technical_design.html">
      Technical Design
    </a>
  
</li>

        
      </ul>
    </details>
  
</li>

      
        

<li class="nav-item">
  
    <details >
      <summary class="nav-link">
        Guides
        <svg class="nav-arrow" viewBox="0 0 24 24" width="24" height="24">
          <path d="M7.41 8.59L12 13.17l4.59-4.58L18 10l-6 6-6-6 1.41-1.41z"/>
        </svg>
      </summary>
      <ul class="nav-list nested">
        
          

<li class="nav-item">
  
    <a class="nav-link " href="/inkorporated/guides/installation.html">
      Installation
    </a>
  
</li>

        
          

<li class="nav-item">
  
    <a class="nav-link " href="/inkorporated/guides/configuration.html">
      Configuration
    </a>
  
</li>

        
          

<li class="nav-item">
  
    <a class="nav-link " href="/inkorporated/guides/environments.html">
      Environments
    </a>
  
</li>

        
          

<li class="nav-item">
  
    <a class="nav-link " href="/inkorporated/guides/deployment.html">
      Deployment & Ops
    </a>
  
</li>

        
          

<li class="nav-item">
  
    <a class="nav-link " href="/inkorporated/guides/security.html">
      Security
    </a>
  
</li>

        
          

<li class="nav-item">
  
    <a class="nav-link " href="/inkorporated/guides/observability.html">
      Observability
    </a>
  
</li>

        
          

<li class="nav-item">
  
    <a class="nav-link " href="/inkorporated/guides/backups.html">
      Backups
    </a>
  
</li>

        
          

<li class="nav-item">
  
    <a class="nav-link " href="/inkorporated/guides/troubleshooting.html">
      Troubleshooting
    </a>
  
</li>

        
      </ul>
    </details>
  
</li>

      
        

<li class="nav-item">
  
    <details >
      <summary class="nav-link">
        Reference
        <svg class="nav-arrow" viewBox="0 0 24 24" width="24" height="24">
          <path d="M7.41 8.59L12 13.17l4.59-4.58L18 10l-6 6-6-6 1.41-1.41z"/>
        </svg>
      </summary>
      <ul class="nav-list nested">
        
          

<li class="nav-item">
  
    <a class="nav-link " href="/inkorporated/reference/services.html">
      Service Catalog
    </a>
  
</li>

        
      </ul>
    </details>
  
</li>

      
        

<li class="nav-item">
  
    <details >
      <summary class="nav-link">
        Status & Reports
        <svg class="nav-arrow" viewBox="0 0 24 24" width="24" height="24">
          <path d="M7.41 8.59L12 13.17l4.59-4.58L18 10l-6 6-6-6 1.41-1.41z"/>
        </svg>
      </summary>
      <ul class="nav-list nested">
        
          

<li class="nav-item">
  
    <a class="nav-link " href="/inkorporated/status/discovery_summary.html">
      Discovery Summary
    </a>
  
</li>

        
          

<li class="nav-item">
  
    <a class="nav-link " href="/inkorporated/status/dgx_integration_summary.html">
      DGX Integration
    </a>
  
</li>

        
          

<li class="nav-item">
  
    <a class="nav-link " href="/inkorporated/status/infrastructure_validation_report.html">
      Infrastructure Validation
    </a>
  
</li>

        
          

<li class="nav-item">
  
    <a class="nav-link active" href="/inkorporated/architecture/dgx_integration_plan.html">
      DGX Plan
    </a>
  
</li>

        
      </ul>
    </details>
  
</li>

      
    </ul>
  
</nav>
<main class="content" aria-label="Content">
        <article class="post">

  <header class="post-header">
    <h1 class="post-title"></h1>
  </header>

  <div class="post-content">
    <h1 id="nvidia-dgx-spark-integration-plan">NVIDIA DGX Spark Integration Plan</h1>

<h2 id="overview">Overview</h2>
<p>This document outlines the technical implementation plan for integrating two NVIDIA DGX Spark systems into the Inkorporated homelab infrastructure. The DGX Spark systems, equipped with NVIDIA Grace CPU and Blackwell GPU architecture, will be added as dedicated GPU-accelerated worker nodes to the existing k3s Kubernetes cluster.</p>

<h2 id="prerequisites">Prerequisites</h2>
<p>Before integrating DGX Spark systems, the following infrastructure components must be deployed:</p>
<ol>
  <li>Longhorn Storage (Block storage for persistent volumes)</li>
  <li>MetalLB (LoadBalancer provider for external services)</li>
  <li>Observability Stack (Prometheus/Grafana/Loki for monitoring)</li>
  <li>cert-manager (TLS automation)</li>
  <li>MinIO Object Storage (Backup target)</li>
</ol>

<h2 id="integration-phases">Integration Phases</h2>

<h3 id="phase-1-prerequisite-infrastructure-deployment">Phase 1: Prerequisite Infrastructure Deployment</h3>
<p>This phase aligns with Phase 4 of the current implementation plan in progress.md.</p>

<h4 id="task-401-deploy-nfs-csi-driver">Task 4.01: Deploy NFS CSI Driver</h4>
<ul>
  <li><strong>Status</strong>: Not Started</li>
  <li><strong>Purpose</strong>: Provide NFS-based persistent volumes for shared storage</li>
  <li><strong>Implementation</strong>: Deploy NFS CSI driver using Helm chart</li>
  <li><strong>Resources</strong>:
    <ul>
      <li>NFS CSI Driver Helm chart</li>
      <li>NFS server configuration</li>
    </ul>
  </li>
</ul>

<h4 id="task-402-deploy-longhorn-storage">Task 4.02: Deploy Longhorn Storage</h4>
<ul>
  <li><strong>Status</strong>: Not Started</li>
  <li><strong>Purpose</strong>: Distributed block storage for GPU workloads</li>
  <li><strong>Implementation</strong>:
    <ul>
      <li>Install Longhorn via Helm chart</li>
      <li>Configure storage class for GPU workloads</li>
      <li>Set up Longhorn volume replication</li>
    </ul>
  </li>
  <li><strong>Resources</strong>:
    <ul>
      <li>Longhorn Helm chart</li>
      <li>Storage configuration for DGX local SSDs</li>
    </ul>
  </li>
</ul>

<h4 id="task-403-deploy-minio-object-storage">Task 4.03: Deploy MinIO Object Storage</h4>
<ul>
  <li><strong>Status</strong>: Not Started</li>
  <li><strong>Purpose</strong>: S3-compatible object storage for backups and AI datasets</li>
  <li><strong>Implementation</strong>:
    <ul>
      <li>Deploy MinIO via Helm chart</li>
      <li>Configure MinIO as backup target</li>
      <li>Set up persistent storage</li>
    </ul>
  </li>
  <li><strong>Resources</strong>:
    <ul>
      <li>MinIO Helm chart</li>
      <li>NFS PVC for data persistence</li>
    </ul>
  </li>
</ul>

<h4 id="task-404-deploy-cert-manager">Task 4.04: Deploy cert-manager</h4>
<ul>
  <li><strong>Status</strong>: Not Started</li>
  <li><strong>Purpose</strong>: TLS certificate automation for secure communication</li>
  <li><strong>Implementation</strong>:
    <ul>
      <li>Install cert-manager via Helm chart</li>
      <li>Configure ClusterIssuer for Letâ€™s Encrypt</li>
    </ul>
  </li>
  <li><strong>Resources</strong>:
    <ul>
      <li>cert-manager Helm chart</li>
      <li>ACME configuration</li>
    </ul>
  </li>
</ul>

<h4 id="task-405-deploy-metallb">Task 4.05: Deploy MetalLB</h4>
<ul>
  <li><strong>Status</strong>: Not Started</li>
  <li><strong>Purpose</strong>: LoadBalancer service type for external access</li>
  <li><strong>Implementation</strong>:
    <ul>
      <li>Install MetalLB via Helm chart</li>
      <li>Configure IP address pool for external services</li>
    </ul>
  </li>
  <li><strong>Resources</strong>:
    <ul>
      <li>MetalLB Helm chart</li>
      <li>IP address configuration</li>
    </ul>
  </li>
</ul>

<h4 id="task-406-deploy-observability-stack">Task 4.06: Deploy Observability Stack</h4>
<ul>
  <li><strong>Status</strong>: Not Started</li>
  <li><strong>Purpose</strong>: Monitor GPU metrics and system performance</li>
  <li><strong>Implementation</strong>:
    <ul>
      <li>Deploy kube-prometheus-stack (Prometheus, Grafana, Loki)</li>
      <li>Configure DCGM exporter for GPU metrics</li>
      <li>Set up monitoring dashboards for AI workloads</li>
    </ul>
  </li>
  <li><strong>Resources</strong>:
    <ul>
      <li>Prometheus/Grafana Helm chart</li>
      <li>DCGM exporter configuration</li>
    </ul>
  </li>
</ul>

<h3 id="phase-2-dgx-spark-integration">Phase 2: DGX Spark Integration</h3>

<h4 id="task-4x-integrate-dgx-spark-systems-as-worker-nodes">Task 4.x: Integrate DGX Spark Systems as Worker Nodes</h4>

<h5 id="physical-setup">Physical Setup</h5>
<ol>
  <li><strong>Network Configuration</strong>
    <ul>
      <li>Connect each DGX Spark system to the LAN switch via Ethernet</li>
      <li>Configure static IPs in management VLAN (e.g., 192.168.1.101/102 for DGX1/DGX2)</li>
      <li>Connect DGX nodes directly with two OSFP cables (200 Gbps each, 400 Gbps total)</li>
      <li>Assign private subnet for direct communication (e.g., 192.168.100.0/24)</li>
      <li>Configure jumbo frames (MTU=9000) for high throughput</li>
      <li>Bond interfaces for redundancy (Linux bonding driver)</li>
    </ul>
  </li>
  <li><strong>Security Configuration</strong>
    <ul>
      <li>Update pfSense firewall rules to allow:
        <ul>
          <li>k3s API access (6443)</li>
          <li>etcd communication (2379-2380)</li>
          <li>Node ports (30000-32767)</li>
        </ul>
      </li>
      <li>Configure DNS entries for DGX nodes (e.g., dgx-spark-1.inkorporated.local)</li>
      <li>Implement network segmentation per multi-zone topology</li>
    </ul>
  </li>
</ol>

<h5 id="software-installation">Software Installation</h5>

<ol>
  <li><strong>k3s Agent Installation</strong>
    <ul>
      <li>Extend existing Ansible playbooks in <code class="language-plaintext highlighter-rouge">infrastructure/ansible/</code></li>
      <li>Join DGX systems as worker nodes to the k3s cluster</li>
      <li>Install required dependencies:
        <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>apt update <span class="o">&amp;&amp;</span> apt upgrade <span class="nt">-y</span>
apt <span class="nb">install </span>curl iptables-persistent <span class="nt">-y</span>
</code></pre></div>        </div>
      </li>
    </ul>
  </li>
  <li><strong>Node Configuration</strong>
    <ul>
      <li>Label nodes for GPU scheduling:
        <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>kubectl label nodes dgx-spark-1 node-role.kubernetes.io/ai-gpu<span class="o">=</span><span class="nb">true </span>nvidia.com/gpu<span class="o">=</span><span class="nb">true
</span>kubectl label nodes dgx-spark-2 node-role.kubernetes.io/ai-gpu<span class="o">=</span><span class="nb">true </span>nvidia.com/gpu<span class="o">=</span><span class="nb">true</span>
</code></pre></div>        </div>
      </li>
      <li>Taint nodes for GPU workloads:
        <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>kubectl taint nodes dgx-spark-1 <span class="nv">dedicated</span><span class="o">=</span>gpu:NoSchedule
kubectl taint nodes dgx-spark-2 <span class="nv">dedicated</span><span class="o">=</span>gpu:NoSchedule
</code></pre></div>        </div>
      </li>
    </ul>
  </li>
</ol>

<h5 id="gpu-operator-deployment">GPU Operator Deployment</h5>

<ol>
  <li><strong>NVIDIA GPU Operator Installation</strong>
    <ul>
      <li>Add NVIDIA Helm repository:
        <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>helm repo add nvidia https://helm.ngc.nvidia.com/nvidia
helm repo update
</code></pre></div>        </div>
      </li>
      <li>Deploy GPU Operator:
        <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>helm <span class="nb">install </span>gpu-operator nvidia/gpu-operator <span class="se">\</span>
  <span class="nt">--set</span> driver.enabled<span class="o">=</span><span class="nb">true</span> <span class="se">\</span>
  <span class="nt">--set</span> devicePlugin.enabled<span class="o">=</span><span class="nb">true</span> <span class="se">\</span>
  <span class="nt">--set</span> dcgm.enabled<span class="o">=</span><span class="nb">true</span> <span class="se">\</span>
  <span class="nt">--set</span> dcgmExporter.enabled<span class="o">=</span><span class="nb">true</span> <span class="se">\</span>
  <span class="nt">--namespace</span> nvidia-gpu-operator <span class="se">\</span>
  <span class="nt">--create-namespace</span>
</code></pre></div>        </div>
      </li>
    </ul>
  </li>
  <li><strong>Verification</strong>
    <ul>
      <li>Verify GPU operator pods:
        <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>kubectl get pods <span class="nt">-n</span> nvidia-gpu-operator
</code></pre></div>        </div>
      </li>
      <li>Test GPU detection:
        <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>kubectl run <span class="nt">-it</span> <span class="nt">--rm</span> <span class="nt">--image</span><span class="o">=</span>nvidia/cuda:12.4.1-base-ubuntu22.04 nvidia-smi
</code></pre></div>        </div>
      </li>
    </ul>
  </li>
</ol>

<h3 id="phase-3-ai-workload-configuration">Phase 3: AI Workload Configuration</h3>

<h4 id="update-existing-ai-services-to-use-gpu-nodes">Update Existing AI Services to Use GPU Nodes</h4>

<ol>
  <li><strong>Ollama Deployment</strong>
    <ul>
      <li>Modify deployment to use node selector:
        <div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">spec</span><span class="pi">:</span>
  <span class="na">template</span><span class="pi">:</span>
    <span class="na">spec</span><span class="pi">:</span>
      <span class="na">nodeSelector</span><span class="pi">:</span>
        <span class="na">node-role.kubernetes.io/ai-gpu</span><span class="pi">:</span> <span class="s2">"</span><span class="s">true"</span>
      <span class="na">tolerations</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">key</span><span class="pi">:</span> <span class="s2">"</span><span class="s">dedicated"</span>
        <span class="na">operator</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Equal"</span>
        <span class="na">value</span><span class="pi">:</span> <span class="s2">"</span><span class="s">gpu"</span>
        <span class="na">effect</span><span class="pi">:</span> <span class="s2">"</span><span class="s">NoSchedule"</span>
</code></pre></div>        </div>
      </li>
    </ul>
  </li>
  <li><strong>Open WebUI Deployment</strong>
    <ul>
      <li>Apply same node selector configuration</li>
      <li>Configure GPU resources in deployment spec:
        <div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">resources</span><span class="pi">:</span>
  <span class="na">limits</span><span class="pi">:</span>
    <span class="na">nvidia.com/gpu</span><span class="pi">:</span> <span class="m">1</span>
  <span class="na">requests</span><span class="pi">:</span>
    <span class="na">nvidia.com/gpu</span><span class="pi">:</span> <span class="m">1</span>
</code></pre></div>        </div>
      </li>
    </ul>
  </li>
  <li><strong>Langflow Deployment</strong>
    <ul>
      <li>Configure node affinity and GPU resources</li>
      <li>Update deployment to target GPU worker nodes</li>
    </ul>
  </li>
</ol>

<h4 id="storage-integration">Storage Integration</h4>

<ol>
  <li><strong>Longhorn Extension</strong>
    <ul>
      <li>Deploy Longhorn agent on DGX nodes</li>
      <li>Configure local SSDs for volume replicas</li>
      <li>Create Longhorn storage class for AI workloads</li>
    </ul>
  </li>
  <li><strong>Persistent Volume Claims</strong>
    <ul>
      <li>Update AI services to use Longhorn PVCs for model storage</li>
      <li>Configure storage size requirements for different AI workloads</li>
    </ul>
  </li>
</ol>

<h3 id="phase-4-monitoring-and-testing">Phase 4: Monitoring and Testing</h3>

<h4 id="gpu-metrics-monitoring">GPU Metrics Monitoring</h4>
<ol>
  <li><strong>DCGM Exporter Configuration</strong>
    <ul>
      <li>Configure DCGM exporter to collect GPU metrics</li>
      <li>Set up Prometheus scrape configuration</li>
      <li>Create Grafana dashboards for GPU utilization</li>
    </ul>
  </li>
  <li><strong>Performance Testing</strong>
    <ul>
      <li>Deploy test CUDA workloads to verify GPU functionality</li>
      <li>Run distributed training jobs to test inter-node communication</li>
      <li>Validate storage performance with AI datasets</li>
    </ul>
  </li>
</ol>

<h4 id="security-implementation">Security Implementation</h4>
<ol>
  <li><strong>RBAC Policies</strong>
    <ul>
      <li>Create role-based access controls for GPU resources</li>
      <li>Implement network policies for GPU node communication</li>
      <li>Configure Authentik integration for admin access</li>
    </ul>
  </li>
</ol>

<h3 id="implementation-timeline">Implementation Timeline</h3>
<ul>
  <li><strong>Week 1</strong>: Complete prerequisite infrastructure deployment (Longhorn, MetalLB, cert-manager, Observability)</li>
  <li><strong>Week 2</strong>: Physical setup and k3s agent installation on DGX systems</li>
  <li><strong>Week 3</strong>: GPU Operator deployment and AI service configuration</li>
  <li><strong>Week 4</strong>: Testing and performance validation</li>
</ul>

<h3 id="risk-mitigation">Risk Mitigation</h3>
<ol>
  <li><strong>Compatibility Risks</strong>
    <ul>
      <li>Test DGX OS compatibility with k3s agent</li>
      <li>Verify NVIDIA driver versions with k3s cluster</li>
    </ul>
  </li>
  <li><strong>Performance Bottlenecks</strong>
    <ul>
      <li>Monitor network throughput with iperf3 tests</li>
      <li>Validate GPU memory allocation and utilization</li>
    </ul>
  </li>
  <li><strong>Rollback Strategy</strong>
    <ul>
      <li>Implement node draining for maintenance</li>
      <li>Maintain backup of existing configurations</li>
      <li>Document rollback procedures for each phase</li>
    </ul>
  </li>
</ol>

<h3 id="resource-requirements">Resource Requirements</h3>
<ul>
  <li><strong>Hardware</strong>: 2x NVIDIA DGX Spark systems (Grace CPU + Blackwell GPU)</li>
  <li><strong>Network</strong>: 10/25/100 Gbps Ethernet connectivity, 400 Gbps direct OSFP links</li>
  <li><strong>Software</strong>:
    <ul>
      <li>k3s cluster (existing)</li>
      <li>NVIDIA GPU Operator Helm chart</li>
      <li>Longhorn storage operator</li>
      <li>Prometheus/Grafana monitoring stack</li>
    </ul>
  </li>
</ul>

<h3 id="success-criteria">Success Criteria</h3>
<ul>
  <li>DGX nodes successfully join k3s cluster as worker nodes</li>
  <li>GPU Operator deployed and functional</li>
  <li>AI services can be scheduled on GPU nodes</li>
  <li>GPU metrics available through monitoring stack</li>
  <li>Performance benchmarks meet expected throughput requirements</li>
</ul>

  </div>

</article>

      </main>
    </div><footer class="footer">
  <div class="wrapper">
    <p>Inkorporated Homelab Documentation &copy; 2026</p>
  </div>
</footer>
<script src="/inkorporated/assets/js/main.js"></script>
    <script src="/inkorporated/assets/js/search.js"></script>

    <!-- Extra JS -->
    
      
        <script src="/inkorporated/assets/js/mermaid-support.js"></script>
      
    

  </body>

</html>
